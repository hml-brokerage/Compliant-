# Test Handoff

This repository includes two turnkey ways to verify the app end-to-end before development work proceeds.

## Option A: Local one-click test

Requirements:
- Node.js 20 and pnpm 8
- Docker (optional; otherwise run PostgreSQL locally on 5432)

Run:
```bash
bash scripts/local-test.sh
# or
pnpm test:all
```
What it does:
- Ensures Node/pnpm
- Prepares `.env` files with sensible defaults
- Starts PostgreSQL (via Docker if available)
- Pushes Prisma schema and seeds demo data
- Installs Playwright browsers
- Runs Playwright E2E and unit tests
- Outputs reports to `playwright-report/` and `coverage/`

## Option B: GitHub Actions CI

Workflow: `.github/workflows/test-all.yml`
- Triggers on push/PR or manual run
- Provisions PostgreSQL service
- Pushes and seeds Prisma schema
- Builds monorepo
- Starts backend and frontend in the background
- Runs unit and Playwright E2E tests
- Uploads Playwright HTML report and JSON results as artifacts

## Environment defaults
- Backend: `packages/backend/.env`
  - `DATABASE_URL=postgresql://postgres:postgres@localhost:5432/compliant_dev`
  - `JWT_SECRET`, `JWT_REFRESH_SECRET` autogenerated if missing
  - `PORT=3001`
- Frontend: `packages/frontend/.env.local`
  - `NEXT_PUBLIC_API_URL=http://localhost:3001/api`

## Troubleshooting
- No Docker available: Install PostgreSQL locally and ensure it listens on `localhost:5432`.
- Playwright fails to launch browsers: run `pnpm exec playwright install --with-deps`.
- Backend not ready: check `backend.log` (in CI) or terminal output (local) and verify `DATABASE_URL`.

## Hand-off summary
Use Option A locally or Option B in CI to validate build and workflows. Artifacts provide test evidence you can share with stakeholders and developers.
